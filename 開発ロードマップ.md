# æ€¥æˆé•·ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—å‘ã‘çµ„ç¹”ç®¡ç†SaaS é–‹ç™ºãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—

## ğŸ“‹ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

### ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒ»èª²é¡Œ
- **ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ**: æ€¥æˆé•·ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ï¼ˆ50äººã€œï¼‰
- **ä¸»è¦èª²é¡Œ**: çµ„ç¹”å†ç·¨ãƒ»éƒ¨ç½²ç§»å‹•ãŒé »ç¹ã€æ¡ç”¨è¨ˆç”»ã¨çµ„ç¹”è¨ˆç”»ã®é€£å‹•ãŒå›°é›£
- **åˆ©ç”¨è€…**: CEOã€äººäº‹ã€çµŒå–¶ä¼ç”»
- **ä¾¡æ ¼**: æœˆé¡5ä¸‡å††å›ºå®šæ–™é‡‘
- **çµ„ç¹”å¤‰æ›´é »åº¦**: æœˆ1å›ç¨‹åº¦

### å·®åˆ¥åŒ–ãƒã‚¤ãƒ³ãƒˆ
1. **æ¡ç”¨è¨ˆç”»ã¨çµ„ç¹”å›³ã®å®Œå…¨é€£å‹•**
2. **æ€¥æˆé•·ä¼æ¥­ç‰¹åŒ–ã®æ©Ÿèƒ½è¨­è¨ˆ**
3. **ã‚·ãƒ³ãƒ—ãƒ«ã§ç›´æ„Ÿçš„ãªUI/UX**

## ğŸ” ç¾åœ¨ã®å®Ÿè£…çŠ¶æ³

### âœ… å®Ÿè£…æ¸ˆã¿æ©Ÿèƒ½
- åŸºæœ¬èªè¨¼ã‚·ã‚¹ãƒ†ãƒ ï¼ˆNextAuth.jsã€4ã¤ã®å½¹å‰²ï¼‰
- å¾“æ¥­å“¡ç®¡ç†ï¼ˆCRUDã€éšå±¤é–¢ä¿‚ï¼‰
- çµ„ç¹”å›³å¯è¦–åŒ–ï¼ˆReact Flowï¼‰
- ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ï¼ˆçµ„ç¹”çŠ¶æ…‹ã®ä¿å­˜ãƒ»æ¯”è¼ƒï¼‰
- ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ³ã‚¸ãƒ³ã®åŸºç›¤
- åŸºæœ¬UIï¼ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã€è¨­å®šç”»é¢ï¼‰

### ğŸ“ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯
- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**: Next.js 15 + TypeScript + React 19
- **ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°**: Tailwind CSS + shadcn/ui
- **å¯è¦–åŒ–**: React Flowï¼ˆçµ„ç¹”å›³å¯è¦–åŒ–ï¼‰
- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**: Supabaseï¼ˆPostgreSQL + Auth + Realtime + Edge Functionsï¼‰
- **æ±ºæ¸ˆ**: Stripeï¼ˆSubscriptions + Invoices + Webhooksï¼‰
- **èªè¨¼**: Supabase Authï¼ˆNextAuth.jsã‹ã‚‰ç§»è¡Œï¼‰

## ğŸš€ 4ãƒ•ã‚§ãƒ¼ã‚ºé–‹ç™ºãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—

### **ãƒ•ã‚§ãƒ¼ã‚º1: æ¡ç”¨è¨ˆç”»MVPï¼ˆ2-3ãƒ¶æœˆï¼‰**
**ç›®æ¨™**: æ¡ç”¨è¨ˆç”»ã¨çµ„ç¹”å›³é€£å‹•ã«ã‚ˆã‚‹å·®åˆ¥åŒ–ä¾¡å€¤ã®æä¾›

#### ä¸»è¦æ©Ÿèƒ½
1. **æ¡ç”¨è¨ˆç”»ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ **
   - æ¡ç”¨äºˆå®šãƒã‚¸ã‚·ãƒ§ãƒ³ã®CRUDæ“ä½œ
   - åŸºæœ¬æƒ…å ±ç®¡ç†ï¼ˆãƒã‚¸ã‚·ãƒ§ãƒ³åã€å¿…è¦ã‚¹ã‚­ãƒ«ã€æƒ³å®šå¹´åã€æ¡ç”¨äºˆå®šæ™‚æœŸã€ç·Šæ€¥åº¦ã€æ¡ç”¨ç†ç”±ã€ãƒ¬ãƒãƒ¼ãƒˆãƒ©ã‚¤ãƒ³ï¼‰

2. **çµ„ç¹”å›³ã¸ã®æ¡ç”¨äºˆå®šè¡¨ç¤º**
   - React Flowæ‹¡å¼µã§ã€Œäºˆå®šãƒã‚¸ã‚·ãƒ§ãƒ³ã€ãƒãƒ¼ãƒ‰è¡¨ç¤º
   - æ—¢å­˜å¾“æ¥­å“¡ã¨æ¡ç”¨äºˆå®šã®è¦–è¦šçš„åŒºåˆ¥
   - ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã§ã®é…ç½®å¤‰æ›´

3. **åŸºæœ¬äºˆç®—è¨ˆç®—**
   - æ¡ç”¨ã«ä¼´ã†äººä»¶è²»å¤‰åŒ–ã®è‡ªå‹•è¨ˆç®—
   - éƒ¨ç½²åˆ¥ã‚³ã‚¹ãƒˆå½±éŸ¿ã®è¡¨ç¤º

4. **æ¡ç”¨ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³è¡¨ç¤º**
   - æœˆæ¬¡/å››åŠæœŸãƒ“ãƒ¥ãƒ¼ã§ã®æ¡ç”¨ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
   - ç·Šæ€¥åº¦ã«ã‚ˆã‚‹å„ªå…ˆåº¦è¡¨ç¤º

#### æŠ€è¡“å®Ÿè£…
```typescript
// æ–°è¦ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«
interface RecruitmentPlan {
  id: string;
  tenant_id: string; // Supabaseãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆå¯¾å¿œ
  positionTitle: string;
  department: string;
  reportingManager: string;
  requiredSkills: string[];
  estimatedSalary: number;
  targetHireDate: Date;
  urgency: 'LOW' | 'MEDIUM' | 'HIGH' | 'CRITICAL';
  reason: 'EXPANSION' | 'REPLACEMENT' | 'NEW_INITIATIVE';
  status: 'PLANNED' | 'IN_PROGRESS' | 'HIRED' | 'CANCELLED';
}

// Supabaseçµ±åˆ
const useRecruitmentPlans = (tenantId: string) => {
  return useQuery({
    queryKey: ['recruitment-plans', tenantId],
    queryFn: () => supabase
      .from('recruitment_plans')
      .select('*')
      .eq('tenant_id', tenantId)
  });
};
```

#### Supabaseè¨­å®š
```sql
-- æ¡ç”¨è¨ˆç”»ãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE recruitment_plans (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  tenant_id UUID REFERENCES tenants(id),
  position_title VARCHAR(255) NOT NULL,
  department VARCHAR(255),
  estimated_salary INTEGER,
  target_hire_date DATE,
  urgency VARCHAR(20) DEFAULT 'MEDIUM',
  status VARCHAR(50) DEFAULT 'PLANNED',
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- RLSè¨­å®š
ALTER TABLE recruitment_plans ENABLE ROW LEVEL SECURITY;
CREATE POLICY "tenant_isolation" ON recruitment_plans 
  FOR ALL USING (tenant_id = get_user_tenant_id());
```

### **ãƒ•ã‚§ãƒ¼ã‚º2: é«˜åº¦ãªã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»æ‰¿èªæ©Ÿèƒ½ï¼ˆ2-3ãƒ¶æœˆï¼‰**
**ç›®æ¨™**: çµŒå–¶åˆ¤æ–­æ”¯æ´æ©Ÿèƒ½ã®å¼·åŒ–

#### ä¸»è¦æ©Ÿèƒ½
1. **æ‰¿èªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚·ã‚¹ãƒ†ãƒ **
   - æ¡ç”¨è¨ˆç”»ã®æ®µéšçš„æ‰¿èªãƒ—ãƒ­ã‚»ã‚¹
   - CEO/äººäº‹/çµŒå–¶ä¼ç”»ã®æ¨©é™åˆ¥æ‰¿èªãƒ•ãƒ­ãƒ¼
   - æ‰¿èªç†ç”±ãƒ»å´ä¸‹ç†ç”±ã®è¨˜éŒ²

2. **é«˜åº¦ãªã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³**
   - æ¡ç”¨è¨ˆç”»ã‚’å«ã‚€çµ„ç¹”å¤‰æ›´ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
   - è¤‡æ•°ã‚·ãƒŠãƒªã‚ªã®åŒæ™‚æ¯”è¼ƒ
   - What-ifåˆ†æã®å¼·åŒ–

3. **è©³ç´°ãªäºˆç®—åˆ†æ**
   - éƒ¨ç½²åˆ¥ã‚³ã‚¹ãƒˆåˆ†æ
   - æ¡ç”¨ROIè¨ˆç®—
   - äºˆç®—ä¸Šé™ã‚¢ãƒ©ãƒ¼ãƒˆ

4. **ãƒ¬ãƒãƒ¼ãƒˆæ©Ÿèƒ½æ‹¡å¼µ**
   - æ¡ç”¨è¨ˆç”»é€²æ—ãƒ¬ãƒãƒ¼ãƒˆ
   - çµ„ç¹”åŠ¹ç‡åˆ†æ
   - æ„æ€æ±ºå®šæ”¯æ´ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰

### **ãƒ•ã‚§ãƒ¼ã‚º3: ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆãƒ»ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£å¯¾å¿œï¼ˆ3-4ãƒ¶æœˆï¼‰**
**ç›®æ¨™**: SaaSåŸºç›¤ã®ç¢ºç«‹ã¨è¤‡æ•°é¡§å®¢å¯¾å¿œ

#### ä¸»è¦æ©Ÿèƒ½
1. **Supabaseãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**
   - Row Level Security (RLS)ã«ã‚ˆã‚‹å®Œå…¨ãƒ‡ãƒ¼ã‚¿åˆ†é›¢
   - Supabase Authã«ã‚ˆã‚‹ãƒ†ãƒŠãƒ³ãƒˆåˆ¥ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†
   - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ©Ÿèƒ½ã«ã‚ˆã‚‹ãƒãƒ«ãƒãƒ¦ãƒ¼ã‚¶ãƒ¼å¯¾å¿œ

2. **èªè¨¼ãƒ»æ¨©é™ã‚·ã‚¹ãƒ†ãƒ æ‹¡å¼µ**
   - Supabase Authçµ±åˆï¼ˆNextAuth.jsã‹ã‚‰ç§»è¡Œï¼‰
   - ç´°ã‹ã„æ¨©é™åˆ¶å¾¡ï¼ˆRLSãƒãƒªã‚·ãƒ¼ï¼‰
   - ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³å¯¾å¿œã¨ãƒ†ãƒŠãƒ³ãƒˆè‡ªå‹•è­˜åˆ¥

3. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–**
   - Edge Functionsæ´»ç”¨ã«ã‚ˆã‚‹é«˜é€Ÿå‡¦ç†
   - Supabaseãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ©Ÿèƒ½ã§ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°
   - PostgreSQLã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æœ€é©åŒ–

4. **ãƒ†ãƒŠãƒ³ãƒˆç®¡ç†ã‚·ã‚¹ãƒ†ãƒ **
   - Stripeé€£æºã«ã‚ˆã‚‹èª²é‡‘çŠ¶æ…‹ç›£è¦–
   - ä½¿ç”¨é‡ç›£è¦–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
   - ãƒ†ãƒŠãƒ³ãƒˆè¨­å®šç®¡ç†

#### SupabaseæŠ€è¡“è¨­è¨ˆ
```sql
-- ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆå¯¾å¿œãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ
CREATE TABLE tenants (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  name VARCHAR(255) NOT NULL,
  subdomain VARCHAR(100) UNIQUE NOT NULL,
  subscription_status VARCHAR(50) DEFAULT 'ACTIVE',
  stripe_customer_id VARCHAR(255),
  stripe_subscription_id VARCHAR(255),
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆSupabase Authçµ±åˆï¼‰
CREATE TABLE user_profiles (
  id UUID REFERENCES auth.users(id) PRIMARY KEY,
  tenant_id UUID REFERENCES tenants(id),
  role VARCHAR(50) NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- RLSãƒãƒªã‚·ãƒ¼è¨­å®š
ALTER TABLE tenants ENABLE ROW LEVEL SECURITY;
ALTER TABLE user_profiles ENABLE ROW LEVEL SECURITY;

-- ãƒ†ãƒŠãƒ³ãƒˆåˆ†é›¢é–¢æ•°
CREATE OR REPLACE FUNCTION get_user_tenant_id()
RETURNS UUID AS $$
BEGIN
  RETURN (SELECT tenant_id FROM user_profiles WHERE id = auth.uid());
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;
```

#### Edge Functionsæ´»ç”¨
```typescript
// äºˆç®—è¨ˆç®—å‡¦ç†ï¼ˆEdge Functionï¼‰
export const calculateBudgetImpact = async (plans: RecruitmentPlan[]) => {
  const { data } = await supabase.functions.invoke('calculate-budget', {
    body: { plans }
  });
  return data;
};

// ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ çµ„ç¹”æ›´æ–°
export const useRealtimeOrgUpdates = (tenantId: string) => {
  useEffect(() => {
    const subscription = supabase
      .channel('org_updates')
      .on('postgres_changes', 
        { event: '*', schema: 'public', table: 'employees', filter: `tenant_id=eq.${tenantId}` },
        handleRealtimeUpdate
      )
      .subscribe();
  }, [tenantId]);
};
```

### **ãƒ•ã‚§ãƒ¼ã‚º4: èª²é‡‘ãƒ»ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºæ©Ÿèƒ½ï¼ˆ2-3ãƒ¶æœˆï¼‰**
**ç›®æ¨™**: åç›ŠåŒ–ã¨é«˜åº¦æ©Ÿèƒ½ã«ã‚ˆã‚‹å·®åˆ¥åŒ–

#### ä¸»è¦æ©Ÿèƒ½
1. **Stripeèª²é‡‘ãƒ»è«‹æ±‚ã‚·ã‚¹ãƒ†ãƒ **
   - æœˆé¡5ä¸‡å††å›ºå®šæ–™é‡‘ã®è‡ªå‹•ç¶™ç¶šèª²é‡‘
   - Stripe Webhookã«ã‚ˆã‚‹ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ”¯æ‰•ã„çŠ¶æ³æ›´æ–°
   - è‡ªå‹•è«‹æ±‚æ›¸ç”Ÿæˆãƒ»é€ä»˜
   - Customer Portalã«ã‚ˆã‚‹æ”¯æ‰•ã„æ–¹æ³•ç®¡ç†

2. **é«˜åº¦ãªåˆ†ææ©Ÿèƒ½**
   - çµ„ç¹”å¥åº·åº¦ã‚¹ã‚³ã‚¢ï¼ˆEdge Functionsæ´»ç”¨ï¼‰
   - æ¡ç”¨åŠ¹ç‡åˆ†æãƒ»ROIè¨ˆç®—
   - æ¥­ç•Œãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯æ¯”è¼ƒ

3. **APIãƒ»é€£æºæ©Ÿèƒ½**
   - Supabase APIè‡ªå‹•ç”Ÿæˆã«ã‚ˆã‚‹å¤–éƒ¨é€£æº
   - Webhookæ©Ÿèƒ½ï¼ˆçµ„ç¹”å¤‰æ›´é€šçŸ¥ï¼‰
   - ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆ/ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆï¼ˆCSVã€JSONï¼‰

4. **ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºæ©Ÿèƒ½**
   - Supabase Authã«ã‚ˆã‚‹SSOå¯¾å¿œ
   - è©³ç´°ç›£æŸ»ãƒ­ã‚°ï¼ˆRLSæ´»ç”¨ï¼‰
   - ã‚«ã‚¹ã‚¿ãƒ ãƒ¬ãƒãƒ¼ãƒˆä½œæˆæ©Ÿèƒ½

#### Stripeçµ±åˆè¨­è¨ˆ
```typescript
// Stripe Subscriptionç®¡ç†
interface StripeIntegration {
  // æ–°è¦ãƒ†ãƒŠãƒ³ãƒˆç™»éŒ²æ™‚
  async createCustomerAndSubscription(tenant: Tenant): Promise<{
    customerId: string;
    subscriptionId: string;
  }> {
    const customer = await stripe.customers.create({
      name: tenant.name,
      email: tenant.adminEmail,
      metadata: { tenantId: tenant.id }
    });

    const subscription = await stripe.subscriptions.create({
      customer: customer.id,
      items: [{ price: 'price_monthly_50000_jpy' }],
      metadata: { tenantId: tenant.id }
    });

    return { customerId: customer.id, subscriptionId: subscription.id };
  }

  // Webhookå‡¦ç†
  async handleWebhook(event: Stripe.Event): Promise<void> {
    switch (event.type) {
      case 'invoice.payment_succeeded':
        await this.updateTenantSubscriptionStatus(event.data.object);
        break;
      case 'invoice.payment_failed':
        await this.handlePaymentFailure(event.data.object);
        break;
    }
  }
}

// Supabase Edge Function (Stripe Webhook)
export const stripeWebhook = async (req: Request) => {
  const sig = req.headers.get('stripe-signature');
  const body = await req.text();
  
  const event = stripe.webhooks.constructEvent(body, sig!, process.env.STRIPE_WEBHOOK_SECRET!);
  
  // Supabaseã«æ”¯æ‰•ã„çŠ¶æ³ã‚’æ›´æ–°
  await supabase
    .from('tenants')
    .update({ subscription_status: getStatusFromEvent(event) })
    .eq('stripe_customer_id', event.data.object.customer);
};
```

## ğŸ—ï¸ æŠ€è¡“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ‹¡å¼µ

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ
```typescript
// æ–°è¦ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«
interface RecruitmentPlan {
  id: string;
  tenantId: string;
  positionTitle: string;
  department: string;
  reportingManager: string;
  requiredSkills: string[];
  estimatedSalary: number;
  targetHireDate: Date;
  urgency: 'LOW' | 'MEDIUM' | 'HIGH' | 'CRITICAL';
  reason: 'EXPANSION' | 'REPLACEMENT' | 'NEW_INITIATIVE';
  status: 'PLANNED' | 'APPROVED' | 'IN_PROGRESS' | 'HIRED' | 'CANCELLED';
  approvalWorkflow?: ApprovalWorkflow;
  budgetImpact: BudgetImpact;
}

interface ApprovalWorkflow {
  id: string;
  steps: ApprovalStep[];
  currentStep: number;
  status: 'PENDING' | 'APPROVED' | 'REJECTED';
  approvers: User[];
  comments: Comment[];
}

interface BudgetImpact {
  monthlyCost: number;
  annualCost: number;
  departmentBudgetImpact: number;
  totalBudgetImpact: number;
  effectiveDate: Date;
}
```

### ã‚µãƒ¼ãƒ“ã‚¹å±¤æ‹¡å¼µ
```typescript
// æ–°è¦ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹
export class RecruitmentPlanManager {
  async createPlan(tenantId: string, plan: RecruitmentPlan): Promise<RecruitmentPlan>
  async updatePlan(planId: string, updates: Partial<RecruitmentPlan>): Promise<RecruitmentPlan>
  async getPlansWithTimeline(tenantId: string, timeRange: DateRange): Promise<RecruitmentPlan[]>
  async calculateBudgetImpact(plans: RecruitmentPlan[]): Promise<BudgetImpact>
}

export class ApprovalWorkflowEngine {
  async submitForApproval(planId: string, approvers: User[]): Promise<ApprovalWorkflow>
  async processApproval(workflowId: string, decision: ApprovalDecision): Promise<ApprovalWorkflow>
  async getWorkflowStatus(workflowId: string): Promise<ApprovalWorkflow>
}

export class BudgetCalculator {
  calculateRecruitmentCost(plan: RecruitmentPlan): BudgetImpact
  getDepartmentBudgetSummary(tenantId: string, departmentId: string): BudgetSummary
  forecastBudgetImpact(plans: RecruitmentPlan[], timeframe: number): BudgetForecast
}
```

### UIæ‹¡å¼µã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
```typescript
// æ–°è¦UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
export const RecruitmentPlanNode: React.FC<{plan: RecruitmentPlan}>
export const RecruitmentTimeline: React.FC<{plans: RecruitmentPlan[]}>
export const BudgetDashboard: React.FC<{impact: BudgetImpact}>
export const ApprovalFlowViewer: React.FC<{workflow: ApprovalWorkflow}>
```

## ğŸ›¡ï¸ ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆè¨­è¨ˆ

### ãƒ‡ãƒ¼ã‚¿åˆ†é›¢æˆ¦ç•¥
- **æ–¹å¼**: Shared Database + tenant_idåˆ†é›¢
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**: Row Level Security (RLS)
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: tenant_id + ä¸»è¦ã‚«ãƒ©ãƒ ã®ã‚³ãƒ³ãƒã‚¸ãƒƒãƒˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

### ãƒ†ãƒŠãƒ³ãƒˆç®¡ç†
```typescript
interface Tenant {
  id: string;
  name: string;
  subdomain: string; // example.orgchart-manager.com
  subscriptionStatus: 'ACTIVE' | 'SUSPENDED' | 'CANCELLED';
  maxEmployees: number;
  features: TenantFeature[];
  billingInfo: BillingInfo;
  createdAt: Date;
}

interface TenantContext {
  tenantId: string;
  user: User;
  permissions: Permission[];
}
```

## ğŸ“Š é–‹ç™ºã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«æ¦‚è¦

| ãƒ•ã‚§ãƒ¼ã‚º | æœŸé–“ | ä¸»è¦ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³ | ãƒãƒ¼ãƒ æ§‹æˆ |
|---------|------|------------------|------------|
| **ãƒ•ã‚§ãƒ¼ã‚º1** | 2-3ãƒ¶æœˆ | æ¡ç”¨è¨ˆç”»MVPå®Œæˆ | ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰1åã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰1å |
| **ãƒ•ã‚§ãƒ¼ã‚º2** | 2-3ãƒ¶æœˆ | æ‰¿èªãƒ»ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Œæˆ | ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰1åã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰1å |
| **ãƒ•ã‚§ãƒ¼ã‚º3** | 3-4ãƒ¶æœˆ | ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆåŒ–å®Œæˆ | ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰1åã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰2å |
| **ãƒ•ã‚§ãƒ¼ã‚º4** | 2-3ãƒ¶æœˆ | èª²é‡‘ãƒ»ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºå®Œæˆ | ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰1åã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰1å |

**åˆè¨ˆé–‹ç™ºæœŸé–“**: 9-13ãƒ¶æœˆ

## ğŸ¯ æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

### å³åº§ã«é–‹å§‹ã™ã¹ãä½œæ¥­
1. **Supabaseç’°å¢ƒæ§‹ç¯‰**
   - Supabaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆãƒ»è¨­å®š
   - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒè¨­è¨ˆãƒ»ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
   - RLSãƒãƒªã‚·ãƒ¼è¨­å®šã¨ãƒ†ãƒŠãƒ³ãƒˆåˆ†é›¢

2. **æ¡ç”¨è¨ˆç”»ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè£…é–‹å§‹**
   - TypeScriptå‹å®šç¾©ï¼ˆRecruitmentPlanç­‰ï¼‰
   - Supabase Clientè¨­å®šã¨Reactçµ±åˆ
   - åŸºæœ¬CRUD APIå®Ÿè£…

3. **React Flowæ‹¡å¼µèª¿æŸ»ãƒ»å®Ÿè£…**
   - æ¡ç”¨äºˆå®šãƒã‚¸ã‚·ãƒ§ãƒ³ç”¨ã‚«ã‚¹ã‚¿ãƒ ãƒãƒ¼ãƒ‰ä½œæˆ
   - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°æ©Ÿèƒ½ï¼ˆSupabase Realtimeï¼‰
   - çµ„ç¹”å›³ã¨ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã®é€£å‹•

4. **Stripeçµ±åˆæº–å‚™**
   - Stripe ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè¨­å®š
   - æœˆé¡5ä¸‡å††å›ºå®šæ–™é‡‘å•†å“ä½œæˆ
   - Webhook ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆè¨­è¨ˆ

5. **UI/UXãƒ‡ã‚¶ã‚¤ãƒ³**
   - æ¡ç”¨äºˆå®šãƒã‚¸ã‚·ãƒ§ãƒ³ã®è¦–è¦šçš„åŒºåˆ¥ãƒ‡ã‚¶ã‚¤ãƒ³
   - ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³è¡¨ç¤ºã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
   - äºˆç®—å½±éŸ¿ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¨­è¨ˆ

### ä¸­æœŸæº–å‚™ä½œæ¥­
1. **Supabase Edge Functionsé–‹ç™º**
   - äºˆç®—è¨ˆç®—ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ å®Ÿè£…
   - æ‰¿èªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å‡¦ç†
   - ãƒãƒƒãƒå‡¦ç†ãƒ»é€šçŸ¥æ©Ÿèƒ½
2. **Stripeèª²é‡‘ãƒ•ãƒ­ãƒ¼è¨­è¨ˆ**
   - Webhookå‡¦ç†ãƒ•ãƒ­ãƒ¼
   - æ”¯æ‰•ã„å¤±æ•—æ™‚ã®å‡¦ç†
   - è«‹æ±‚æ›¸ç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯
3. **ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆé‹ç”¨è¨­è¨ˆ**
   - ãƒ†ãƒŠãƒ³ãƒˆç®¡ç†ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
   - ä½¿ç”¨é‡ç›£è¦–ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆ
   - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–

## ğŸ’¡ æˆåŠŸè¦å› 

1. **æ˜ç¢ºãªå·®åˆ¥åŒ–**: æ¡ç”¨è¨ˆç”»é€£å‹•ã¨ã„ã†ä»–ã«ãªã„ä¾¡å€¤æä¾›
2. **ã‚¿ãƒ¼ã‚²ãƒƒãƒˆç‰¹åŒ–**: æ€¥æˆé•·ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ã®èª²é¡Œã«é›†ä¸­
3. **æ®µéšçš„é–‹ç™º**: MVPã‹ã‚‰å§‹ã‚ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’å–å¾—
4. **ãƒ¢ãƒ€ãƒ³ãªæŠ€è¡“åŸºç›¤**: Supabase + Stripeã«ã‚ˆã‚‹é«˜é€Ÿé–‹ç™ºãƒ»é‹ç”¨
5. **åç›Šãƒ¢ãƒ‡ãƒ«**: æ˜ç¢ºãªä¾¡æ ¼è¨­å®šï¼ˆæœˆé¡5ä¸‡å††å›ºå®šï¼‰ã¨Stripeè‡ªå‹•èª²é‡‘

## ğŸ”§ æŠ€è¡“çš„ã‚¢ãƒ‰ãƒãƒ³ãƒ†ãƒ¼ã‚¸

### **Supabaseæ´»ç”¨ãƒ¡ãƒªãƒƒãƒˆ**
- **é–‹ç™ºé€Ÿåº¦**: PostgreSQL + Auth + API + RealtimeãŒçµ±åˆæ¸ˆã¿
- **ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£**: è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã¨ã‚°ãƒ­ãƒ¼ãƒãƒ«é…ä¿¡
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**: RLSã«ã‚ˆã‚‹ä¼æ¥­ãƒ¬ãƒ™ãƒ«ã®ãƒ‡ãƒ¼ã‚¿åˆ†é›¢
- **é‹ç”¨ã‚³ã‚¹ãƒˆ**: ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹æ§‹æˆã§åˆæœŸã‚³ã‚¹ãƒˆæœ€å°åŒ–

### **Stripeçµ±åˆãƒ¡ãƒªãƒƒãƒˆ**
- **èª²é‡‘ã®ç¢ºå®Ÿæ€§**: è‡ªå‹•ç¶™ç¶šèª²é‡‘ã¨ãƒªãƒˆãƒ©ã‚¤æ©Ÿèƒ½
- **ã‚°ãƒ­ãƒ¼ãƒãƒ«å¯¾å¿œ**: å¤šé€šè²¨ãƒ»å¤šå›½ç¨åˆ¶å¯¾å¿œ
- **ç®¡ç†åŠ¹ç‡**: Customer Portalã§é¡§å®¢ã‚»ãƒ«ãƒ•ã‚µãƒ¼ãƒ“ã‚¹
- **é€æ˜æ€§**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ èª²é‡‘çŠ¶æ³ç›£è¦–

---

**ã“ã®ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—ã«ã‚ˆã‚Šã€æ€¥æˆé•·ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ã®çµ„ç¹”ç®¡ç†èª²é¡Œã‚’è§£æ±ºã™ã‚‹å·®åˆ¥åŒ–ã•ã‚ŒãŸSaaSãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã®æ§‹ç¯‰ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚**